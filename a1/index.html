<!DOCTYPE html>
<html>
<head>

/*
Austin Bradstreet, 004880497
CS-351, First Time using HTML & Javascript
*/

<h1>Assignment 1</<h1>

<script 
    src="https://code.jquery.com/jquery-3.4.1.js" 
    integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
    crossorigin="anonymous">
</script>

</head>


<body>

<h1> Music Box Page </h1>

<textarea id = "input_notes" rows="4" cols="4">
A
 B
  C
   D
</textarea>

<textarea id="compiled_code" rows="40" cols="60">
</textarea>


<script>
	{
    
    notes_raw = $("#input_notes").val().split(/\r?\n/)

    var notes_parsed = []

    var audio1 = new Audio('a_note.mp3') //A Note
	var audio2 = new Audio('b_note.mp3') //B Note
    var audio3 = new Audio('c_note.mp3') //C Note
	var audio4 = new Audio('d_note.mp3') //D Note


    function complete() 
	{
		alert("The sound is done")
	}


	for(index = 0; index < notes_raw.length; index++)
    {
		if(notes_raw[index][0] == 'A')
        {
			notes_parsed.push('A')
		}
        else if(notes_raw[index][1] == 'B')
        {
			notes_parsed.push('B')
		}
        else if(notes_raw[index][2] == 'C')
        {
			notes_parsed.push('C')
		} 
        else if(notes_raw[index][3] == 'D')
        {
			notes_parsed.push('D')
	    } 
    }

var htmlTEMPLATE = "<!doctype html>"
	htmlTEMPLATE = htmlTEMPLATE + "<html><head><\/head ><body>"
	htmlTEMPLATE = htmlTEMPLATE + "<script>@@@PLAY_CODE <\/script>"
	htmlTEMPLATE = htmlTEMPLATE + "<\/body ><\/html>"

time = 0
 index_ms_timeStop = 4000
	for(index = 0; index < notes_parsed.length; index++)
	{
		if(notes_parsed[index] == 'A')
		{
			setTimeout(function(){audio1.play()}, index_ms_timeStop * index)
			audio1.addEventListener("fin", complete)
		} 
        else if(notes_parsed[index] == 'B')
		{
			setTimeout(function(){audio2.play()}, index_ms_timeStop * index)
			audio2.addEventListener("fin", complete)
		}
        else if(notes_parsed[index] == 'C')
		{
			setTimeout(function(){audio3.play()}, index_ms_timeStop * index)
			audio2.addEventListener("fin", complete)
		}
        else if(notes_parsed[index] == 'D')
		{
			setTimeout(function(){audio4.play()}, index_ms_timeStop * index)
			audio2.addEventListener("fin", complete)
		}
	}

	
	code_output = ""
	
	for(index = 0; index < notes_parsed.length; index++)
	{
		if(notes_parsed[index] == 'A')
		{
			code_output = code_output + "setTimeout(function(){"
			code_output = code_output + "new Audio('a_note.mp3').play()"
			code_output = code_output + "}, " + index_ms_timeStop + " * " + index + "); "
        } 

        else if(notes_parsed[index] == 'B')
		{
			code_output = code_output + "setTimeout(function(){"
			code_output = code_output + "new Audio('b_note.mp3').play()"
			code_output = code_output + "}, " + index_ms_timeStop + " * " +  index + ");"
			
		}
        else if (notes_parsed[index] == 'C')
		{
			code_output = code_output + "setTimeout( function(){"
            code_output = code_output + "new Audio('c_note.mp3').play()"
            code_output = code_output + "}, " + index_ms_timeStop + " * " + index + ");  "
		}
		else if (notes_parsed[index] == 'D')
		{
			code_output = code_output + "setTimeout( function(){"
            code_output = code_output + "new Audio('d_note.mp3').play()"
            code_output = code_output + "}, " + index_ms_timeStop + " * " + index + ");  "
		}

	}
	
	$("#compiled_code").val(htmlTEMPLATE.replace("@@@PLAY_CODE", code_output))
    
    }


</script>

</body>
</html>
